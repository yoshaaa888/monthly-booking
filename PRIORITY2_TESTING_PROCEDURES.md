# Priority 2: 予約カレンダー安定化 - 手動テスト手順

## テスト環境
- WordPress管理画面
- ブラウザ開発者ツール（コンソール）

## テスト手順

### 1. 正常動作確認
1. WordPress管理画面 → Monthly Booking → 予約カレンダー にアクセス
2. 部屋選択ドロップダウンが正常に表示されることを確認
3. 部屋を選択して180日間のカレンダーが表示されることを確認
4. ブラウザコンソールにエラーがないことを確認

### 2. エラーハンドリング確認
1. ブラウザ開発者ツール → ネットワークタブを開く
2. AJAXリクエストを無効化（ネットワークをオフラインに設定）
3. ページを再読み込みして適切なエラーメッセージが表示されることを確認
   - 「キャンペーン割り当ての読み込みに失敗しました。ページを再読み込みしてください。」
   - 「アクティブキャンペーンの読み込みに失敗しました」
   - 「エラー：予約データの取得に失敗しました。ページを再読み込みしてください。」

### 3. JavaScript例外処理確認
1. ブラウザコンソールで以下のコマンドを実行して意図的にエラーを発生させる:
   ```javascript
   // カレンダー描画エラーのテスト
   $('.calendar-grid').remove();
   MonthlyBookingCalendar.refresh();
   ```
2. システム全体が停止しないことを確認
3. 適切なエラーメッセージが表示されることを確認
   - 「カレンダーの表示でエラーが発生しました。」

### 4. 部屋データ空の場合のテスト
1. データベースで一時的に全ての部屋を非アクティブにする
2. 予約カレンダーページにアクセス
3. 「表示できる部屋がありません。先に部屋を登録してください。」メッセージが表示されることを確認
4. 部屋データを元に戻す

### 5. 部屋選択機能テスト
1. 部屋選択ドロップダウンをクリック
2. 複数の部屋が表示されることを確認
3. 異なる部屋を選択してページが正しく遷移することを確認
4. 選択した部屋のカレンダーが表示されることを確認

## 期待される結果

### 正常時
- 部屋選択ドロップダウンに利用可能な部屋が表示される
- 部屋選択後、180日間のカレンダーが表示される
- JavaScriptコンソールにエラーが表示されない

### エラー時
- ネットワークエラー時に適切な日本語エラーメッセージが表示される
- JavaScript例外が発生してもシステム全体が停止しない
- 部屋データが空の場合に適切な案内メッセージが表示される

## トラブルシューティング

### よくある問題
1. **部屋選択ドロップダウンが空**
   - データベースの`wp_monthly_rooms`テーブルを確認
   - `is_active = 1`の部屋が存在するか確認

2. **JavaScriptエラーが継続する**
   - ブラウザキャッシュをクリア
   - 他のプラグインとの競合を確認

3. **カレンダーが表示されない**
   - WordPress管理画面でプラグインが有効化されているか確認
   - テーマとの互換性を確認

## 検証チェックリスト
- [ ] 部屋選択ドロップダウンが正常に動作する
- [ ] カレンダーが正しく表示される
- [ ] ネットワークエラー時に適切なメッセージが表示される
- [ ] JavaScript例外でシステムが停止しない
- [ ] 部屋データが空の場合に適切な案内が表示される
- [ ] ブラウザコンソールにエラーが表示されない
- [ ] 全ての機能が日本語で表示される
