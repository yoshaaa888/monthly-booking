# Monthly Booking WordPress プラグイン - 完全セットアップパッケージ v2.2-final

## 📦 パッケージ概要

WordPress を一から立ち上げ直して、Monthly Booking プラグイン v2.2-final を完全にセットアップするための包括的なパッケージです。

**✅ データベーススキーマ互換性確認済み** - seed_data.sql は v2.2-final のテーブル構造と完全に互換性があります。

## 🎯 含まれるファイル

### 1. プラグインファイル
- `monthly-booking-v2.2-final.zip` - 最新版プラグイン（v2.2-final）
  - Priority 1-4 修正適用済み
  - デフォルト日額賃料削除
  - キャンペーン重複チェック・180日制限実装
  - プラグイン設定ページ削除

### 2. データベースセットアップ
- `seed_data.sql` - サンプルデータ投入用SQLファイル（v2.2-final互換）
  - 物件データ: 5件（立川・新宿・渋谷・池袋・品川）
  - オプション: 9件（割引対象7件・対象外2件）
  - キャンペーン: 2件（早割10%・即入居割20%）
  - 顧客データ: 3件のサンプル顧客
- `SCHEMA_COMPATIBILITY_VERIFICATION.md` - データベーススキーマ互換性確認書

### 3. セットアップマニュアル
- `INSTALLATION_MANUAL.md` - 完全インストール手順（Local WP対応）
- `SETUP_PAGES_MANUAL.md` - WordPressページ作成手順
- `TESTING_PROCEDURES.md` - Priority 1-4修正の動作確認手順

### 4. テスト環境
- `playwright/` - Playwright自動テスト環境
- `manuals/` - 手動テスト手順

## 🚀 クイックスタート（5分セットアップ）

### Step 1: WordPress環境準備
```bash
# Local WP でサイト作成
# サイト名: t-monthlycampaign
# ドメイン: t-monthlycampaign.local
```

### Step 2: プラグインインストール
1. WordPress管理画面 → プラグイン → 新規追加
2. `monthly-booking-v2.2-final.zip` をアップロード
3. プラグインを有効化（自動でテーブル作成）

### Step 3: サンプルデータ投入
1. Local WP → Database → Open Adminer
2. `seed_data.sql` の内容をコピー&ペースト実行
3. 実行結果確認: Rooms: 5, Options: 9, Campaigns: 2, Customers: 3

### Step 4: ページ作成
1. 見積もりページ: `[monthly_booking_estimate]`
2. カレンダーページ: `[monthly_booking_calendar]`
3. 詳細手順は `SETUP_PAGES_MANUAL.md` を参照

### Step 5: 動作確認
- URL: `http://t-monthlycampaign.local/monthly-estimate/`
- 部屋選択、日付入力、見積計算をテスト
- Priority 1-4修正の確認は `TESTING_PROCEDURES.md` を参照

## 📋 詳細セットアップ手順

詳細な手順は以下のマニュアルを参照してください：

1. **INSTALLATION_MANUAL.md** - 完全インストール手順（Local WP環境）
2. **SETUP_PAGES_MANUAL.md** - WordPressページ作成（ショートコード設定）
3. **TESTING_PROCEDURES.md** - Priority 1-4修正の動作確認手順

## 🔍 データベーススキーマ互換性

**✅ 確認済み**: seed_data.sql は v2.2-final プラグインのデータベーススキーマと完全に互換性があります。

### テーブル構造確認
- `wp_monthly_rooms` - 物件マスタ（5件のサンプルデータ）
- `wp_monthly_options` - オプションマスタ（9件のサンプルデータ）
- `wp_monthly_campaigns` - キャンペーンマスタ（2件のサンプルデータ）
- `wp_monthly_customers` - 顧客マスタ（3件のサンプルデータ）
- `wp_monthly_bookings` - 予約データ（テスト用）
- `wp_monthly_booking_options` - 予約オプション関連
- `wp_monthly_fee_settings` - 料金設定（プラグイン自動作成）

### v2.2-final での変更点
- ❌ デフォルト日額賃料（default_rates）完全削除
- ✅ キャンペーン重複名チェック実装
- ✅ キャンペーン180日制限実装
- ❌ プラグイン設定ページ削除

## 🎪 サンプルデータ内容

### 物件データ（5件）
- 立川マンスリー101号室（¥2,400/日）
- 新宿レジデンス205号室（¥3,200/日）
- 渋谷アパートメント302号室（¥2,800/日）
- 池袋ハイツ403号室（¥2,600/日）
- 品川タワー1205号室（¥3,800/日）

### オプション商品（9件）
- 調理器具セット（¥6,600）
- 食器類（¥3,900）
- 洗剤類（¥3,800）
- タオル類（¥2,900）
- アメニティ類（¥3,500）
- 寝具カバーセット（¥4,530）
- 毛布（¥3,950）
- アイロン（¥6,860）- 割引対象外
- 炊飯器（¥6,600）- 割引対象外

### キャンペーン（2件）
- 早割キャンペーン（30日前予約で10%OFF）
- 即入居割（7日以内入居で20%OFF）

### テスト顧客（3件）
- 田中太郎、佐藤花子、鈴木次郎

## 🧪 テストシナリオ

### シナリオ1: 早割キャンペーン
- チェックイン: 35日後
- 滞在期間: 60日（Sプラン）
- 人数: 大人2名
- 期待結果: 早割10%OFF適用

### シナリオ2: 即入居割
- チェックイン: 3日後
- 滞在期間: 10日（SSプラン）
- 人数: 大人1名、子供1名
- 期待結果: 即入居割20%OFF適用

### シナリオ3: 通常料金
- チェックイン: 15日後
- 滞在期間: 40日（Sプラン）
- 人数: 大人1名
- 期待結果: キャンペーン適用なし

## 🔧 技術仕様

### 対応環境
- WordPress: 5.0以上
- PHP: 7.4以上
- MySQL: 5.7以上
- 推奨環境: Local WP (Local by Flywheel)

### 主要機能
- 料金自動計算（プラン自動判定）
- キャンペーン自動適用
- オプション割引システム
- 予約データ管理
- カレンダー表示（180日間）

## 📞 サポート

### トラブルシューティング
- プラグイン有効化エラー → WordPress/PHPバージョン確認
- ショートコード表示されない → プラグイン有効化・ページ再読み込み
- データベースエラー → テーブルプレフィックス確認
- 見積計算エラー → ブラウザコンソールでJavaScriptエラー確認

### ログ確認場所
- WordPress: `wp-content/debug.log`
- Local WP: Localアプリ「Logs」タブ
- Playwright: `test-results/` フォルダ

## ✅ 成功確認チェックリスト

### 基本セットアップ
- [ ] プラグインが正常に有効化される
- [ ] サンプルデータが正しく投入される（5+9+2+3件）
- [ ] 見積もりページが表示される
- [ ] カレンダーページが表示される
- [ ] 部屋選択ドロップダウンが動作する

### 機能確認
- [ ] 見積計算が正確に実行される
- [ ] キャンペーンが自動適用される（早割・即入居割）
- [ ] 予約申し込みが完了する
- [ ] 管理画面で予約データが確認できる

### Priority 1-4修正確認
- [ ] 料金設定ページに「デフォルト日額賃料」が表示されない
- [ ] キャンペーン設定で重複名エラーが表示される
- [ ] キャンペーン終了日が180日以内に制限される
- [ ] 管理メニューに「プラグイン設定」が表示されない

## 📞 サポート情報

### 環境要件
- **OS**: Windows 11（推奨）
- **WordPress**: 5.0以上
- **PHP**: 7.4以上
- **MySQL**: 5.7以上
- **開発環境**: Local WP (Local by Flywheel)

### トラブルシューティング
- **プラグイン有効化エラー**: WordPress/PHPバージョン確認
- **ショートコード表示されない**: プラグイン有効化・ページ再読み込み
- **データベースエラー**: テーブルプレフィックス（wp_）確認
- **見積計算エラー**: ブラウザコンソールでJavaScriptエラー確認

このパッケージにより、Monthly Booking プラグイン v2.2-final の完全な動作環境を5分でセットアップできます。
